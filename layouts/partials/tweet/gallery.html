{{/* Renders a gallery of up to 4 photos */}}

{{ with .ctx.photos }}
{{ $photo_count := len . }}
{{/*  Wrapper with a gallery-n class for styling purposes */}}
<div class="gallery gallery-{{ $photo_count }}">
  {{ range $i, $p :=  . }}
      <picture>
        {{/*  Download Image. Block is skipped if not possible */}}
        {{ with resources.GetRemote .url }}
        {{ with .Err }}
        {{ warnf "%s" . }}
        {{ else }}
            {{ $img := . }}
            {{ $filename := print "/twitter/media/photos/" $.ctx.id_str "-" $i "." $img.MediaType.SubType }}
            {{ $img := $img.Content | resources.FromString $filename }}
            <source srcset="{{ $img.RelPermalink }}" type="{{ $img.MediaType }}">
            {{ end }}
        {{ end }}

        <img
        src="{{ $p.url}}"
        {{ if eq 1 $photo_count }}
          width="{{ $p.width }}"
          height="{{ $p.height }}"
          style="aspect-ratio: {{ $p.width}}/{{ $p.height}}" 
        {{ end }}
        {{ if $p.accessibilityLabel}}
          alt='{{ $p.accessibilityLabel }}'
        {{ else }}
          alt=""
        {{ end }}
        />
      </picture>
    {{ end }}
  </div>
{{ end }}